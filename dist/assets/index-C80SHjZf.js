import{n as F,p as m,q as b,V as h,k as M}from"./VAvatar-Cjt3-t6c.js";import{c as T,d as Z,s as L}from"./VList-Bw5JRA7I.js";import{Q as H,r as k,R as I,c as N,d as R,Y as c,W as i,V as f,u as $,X as s,x as e,H as n,_ as o,Z as p}from"./index--uryIc9t.js";import{V as d,a as S}from"./VRow-D5wFdFeI.js";import{V as v,a as g,b as y}from"./VCard-Baw6fKXM.js";import{V as j}from"./VDataTable-Dprc95IX.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css              */import"./VSelect-C7-6oE3D.js";import"./VTextField-B7WNoRZT.js";import"./forwardRefs-TdIUcFqw.js";import"./VOverlay-CaEAIGL2.js";import"./dialog-transition-C45ZtiWV.js";import"./VChip-CTpQQSB7.js";const E="data:image/svg+xml,%3csvg%20width='512'%20height='512'%20viewBox='0%200%20512%20512'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M261.126%20140.65L164.624%20307.732L256.001%20466L377.028%20256.5L498.001%2047H315.192L261.126%20140.65Z'%20fill='%231697F6'/%3e%3cpath%20d='M135.027%20256.5L141.365%20267.518L231.64%20111.178L268.731%2047H256H14L135.027%20256.5Z'%20fill='%23AEDDFF'/%3e%3cpath%20d='M315.191%2047C360.935%20197.446%20256%20466%20256%20466L164.624%20307.732L315.191%2047Z'%20fill='%231867C0'/%3e%3cpath%20d='M268.731%2047C76.0026%2047%20141.366%20267.518%20141.366%20267.518L268.731%2047Z'%20fill='%237BC6FF'/%3e%3c/svg%3e",q={key:0,class:"text-h3 text-primary"},P={key:0,class:"text-h3 text-primary"},Q={key:0,class:"text-h3 text-primary"},W=H({__name:"index",setup(X){const l=k({assignments:!1,students:!1,submissions:!1,recentSubmissions:!1}),C=F(),w=I(),r=k({assignmentCount:0,studentCount:0,submissionCount:0}),V=k([]),A=[{title:"标题",key:"title"},{title:"学生",key:"studentName"},{title:"分数",key:"finalScore"},{title:"提交时间",key:"createdAt"},{title:"操作",key:"actions",sortable:!1}],_=N(()=>C.isAuthenticated);async function B(){if(_.value){l.value.assignments=!0;try{const a=await T();r.value.assignmentCount=a.length||0}catch(a){console.error("获取作文题目失败:",a)}finally{l.value.assignments=!1}l.value.students=!0;try{const a=await Z({});r.value.studentCount=a.length||0}catch(a){console.error("获取学生数量失败:",a)}finally{l.value.students=!1}l.value.submissions=!0;try{const a=await L({top:1e3});r.value.submissionCount=a.length||0}catch(a){console.error("获取作文提交数量失败:",a)}finally{l.value.submissions=!1}}}async function D(){if(_.value){l.value.recentSubmissions=!0;try{const a=await L({top:5});V.value=a||[]}catch(a){console.error("获取最近作文提交失败:",a)}finally{l.value.recentSubmissions=!1}}}function x(a){w.push(a)}return R(()=>{_.value&&(B(),D())}),(a,t)=>(i(),c("div",null,[$(C).isAuthenticated?(i(),f(S,{key:0},{default:s(()=>[e(d,{cols:"12"},{default:s(()=>t[3]||(t[3]=[n("h1",{class:"text-h4 mb-4"},"欢迎使用作文评测系统",-1)])),_:1,__:[3]}),e(d,{cols:"12",md:"4"},{default:s(()=>[n("div",{class:"stat-card-hover",onClick:t[0]||(t[0]=u=>x("/assignments"))},[e(v,{class:"mb-4 stat-card",height:"150"},{default:s(()=>[e(g,{class:"text-h6"},{default:s(()=>[e(m,{left:"",color:"primary",class:"mr-2"},{default:s(()=>t[4]||(t[4]=[o("mdi-book-open-page-variant")])),_:1,__:[4]}),t[5]||(t[5]=o(" 作文题目 "))]),_:1,__:[5]}),e(y,{class:"d-flex align-center justify-center"},{default:s(()=>[l.value.assignments?(i(),f(b,{key:1,indeterminate:"",color:"primary"})):(i(),c("div",q,p(r.value.assignmentCount),1))]),_:1}),t[6]||(t[6]=n("div",{class:"stat-card-mask"}," 查看全部 ",-1))]),_:1,__:[6]})])]),_:1}),e(d,{cols:"12",md:"4"},{default:s(()=>[n("div",{class:"stat-card-hover",onClick:t[1]||(t[1]=u=>x("/students"))},[e(v,{class:"mb-4 stat-card",height:"150"},{default:s(()=>[e(g,{class:"text-h6"},{default:s(()=>[e(m,{left:"",color:"primary",class:"mr-2"},{default:s(()=>t[7]||(t[7]=[o("mdi-account-group")])),_:1,__:[7]}),t[8]||(t[8]=o(" 学生人数 "))]),_:1,__:[8]}),e(y,{class:"d-flex align-center justify-center"},{default:s(()=>[l.value.students?(i(),f(b,{key:1,indeterminate:"",color:"primary"})):(i(),c("div",P,p(r.value.studentCount),1))]),_:1}),t[9]||(t[9]=n("div",{class:"stat-card-mask"}," 查看全部 ",-1))]),_:1,__:[9]})])]),_:1}),e(d,{cols:"12",md:"4"},{default:s(()=>[n("div",{class:"stat-card-hover",onClick:t[2]||(t[2]=u=>x("/essays"))},[e(v,{class:"mb-4 stat-card",height:"150"},{default:s(()=>[e(g,{class:"text-h6"},{default:s(()=>[e(m,{left:"",color:"primary",class:"mr-2"},{default:s(()=>t[10]||(t[10]=[o("mdi-clipboard-text")])),_:1,__:[10]}),t[11]||(t[11]=o(" 作文提交 "))]),_:1,__:[11]}),e(y,{class:"d-flex align-center justify-center"},{default:s(()=>[l.value.submissions?(i(),f(b,{key:1,indeterminate:"",color:"primary"})):(i(),c("div",Q,p(r.value.submissionCount),1))]),_:1}),t[12]||(t[12]=n("div",{class:"stat-card-mask"}," 查看全部 ",-1))]),_:1,__:[12]})])]),_:1}),e(d,{cols:"12"},{default:s(()=>[e(v,null,{default:s(()=>[e(g,{class:"text-h6"},{default:s(()=>[e(m,{left:"",color:"primary",class:"mr-2"},{default:s(()=>t[13]||(t[13]=[o("mdi-history")])),_:1,__:[13]}),t[14]||(t[14]=o(" 最近作文提交 "))]),_:1,__:[14]}),e(y,null,{default:s(()=>[e(j,{headers:A,items:V.value,loading:l.value.recentSubmissions,"loading-text":"加载中...","no-data-text":"暂无数据"},{"item.createdAt":s(({item:u})=>[o(p(new Date(u.createdAt).toLocaleString()),1)]),"item.actions":s(({item:u})=>[e(h,{icon:"",variant:"text",size:"small",to:`/essays/${u.id}`},{default:s(()=>[e(m,null,{default:s(()=>t[15]||(t[15]=[o("mdi-eye")])),_:1,__:[15]})]),_:2},1032,["to"])]),_:1},8,["items","loading"])]),_:1})]),_:1})]),_:1})]),_:1})):(i(),f(S,{key:1},{default:s(()=>[e(d,{cols:"12",class:"text-center"},{default:s(()=>[e(M,{src:E,height:"200",class:"mx-auto mb-6",contain:""}),t[17]||(t[17]=n("h1",{class:"text-h3 mb-6"},"作文评测系统",-1)),t[18]||(t[18]=n("p",{class:"text-body-1 mb-6"},"请登录以使用系统功能",-1)),e(h,{color:"primary",size:"large",to:"/login"},{default:s(()=>t[16]||(t[16]=[o(" 立即登录 ")])),_:1,__:[16]})]),_:1,__:[17,18]})]),_:1}))]))}}),rt=z(W,[["__scopeId","data-v-6aea0bce"]]);export{rt as default};
