import{b as _,V as o,g as S}from"./VList-DXkKCcoE.js";import{a as C,V as m}from"./VRow-DDqpY3dd.js";import{V as N}from"./VSpacer-hqQAeQtU.js";import{V as B,q as M,p as a,C as w}from"./VAvatar-60eLK1cy.js";import{V as A}from"./VAlert-D60Ja8ie.js";import{V as v,a as f}from"./VCard-DzPeIVHj.js";import{V as k}from"./VChip-m9RGjYNR.js";import{V as U}from"./VContainer-Dteauxso.js";import{Q as L,r as V,d as P,ao as T,V as I,W as r,X as t,x as e,Y as b,a0 as x,H as u,_ as s,Z as n}from"./index-B1k2TmTq.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css              */const D={class:"d-flex align-center mb-4"},E={key:0,class:"text-center"},R={key:1,class:"text-center"},z=["href"],F={key:1},G={class:"d-flex flex-column text-right",style:{width:"120px"}},H={class:"d-flex flex-column text-right",style:{width:"120px"}},J=L({__name:"status",setup(Q){const l=V(null),p=V(!0),c=V(null);let y=null;const h=d=>d?parseFloat(d)/2048*100:0,g=async()=>{try{p.value=!0,l.value=await S(),c.value=null}catch(d){c.value="获取服务器状态失败，请稍后重试。",console.error(d)}finally{p.value=!1}};return P(()=>{g(),y=window.setInterval(g,5e3)}),T(()=>{y&&window.clearInterval(y)}),(d,i)=>(r(),I(U,null,{default:t(()=>[e(C,null,{default:t(()=>[e(m,{cols:"12"},{default:t(()=>[u("div",D,[i[0]||(i[0]=u("h1",{class:"text-h4"},"服务器状态",-1)),e(N),e(B,{loading:p.value,icon:"mdi-refresh",variant:"text",onClick:g},null,8,["loading"])])]),_:1})]),_:1}),p.value&&!l.value?(r(),b("div",E,[e(M,{indeterminate:"",color:"primary"})])):x("",!0),c.value?(r(),b("div",R,[e(A,{type:"error",prominent:"",border:"start"},{default:t(()=>[s(n(c.value),1)]),_:1})])):x("",!0),l.value?(r(),I(C,{key:2},{default:t(()=>[e(m,{cols:"12",md:"6"},{default:t(()=>[e(v,null,{default:t(()=>[e(f,null,{default:t(()=>i[1]||(i[1]=[s("概览")])),_:1,__:[1]}),e(_,{lines:"one"},{default:t(()=>[e(o,{title:"服务器状态"},{prepend:t(()=>[e(a,{icon:"mdi-server-network"})]),append:t(()=>[e(k,{color:l.value.serverStatus==="Running"?"green":"red","text-color":"white",small:""},{default:t(()=>[s(n(l.value.serverStatus),1)]),_:1},8,["color"])]),_:1}),e(o,{title:"数据库状态"},{prepend:t(()=>[e(a,{icon:"mdi-database"})]),append:t(()=>[e(k,{color:l.value.databaseStatus==="Connected"?"green":"red","text-color":"white",small:""},{default:t(()=>[s(n(l.value.databaseStatus),1)]),_:1},8,["color"])]),_:1}),e(o,{title:"持续运行时间",subtitle:l.value.uptime},{prepend:t(()=>[e(a,{icon:"mdi-timer-sand"})]),_:1},8,["subtitle"]),e(o,{title:"服务器时间 (UTC)",subtitle:new Date(l.value.serverTimeUtc).toLocaleString()},{prepend:t(()=>[e(a,{icon:"mdi-clock-outline"})]),_:1},8,["subtitle"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12",md:"6"},{default:t(()=>[e(v,null,{default:t(()=>[e(f,null,{default:t(()=>i[2]||(i[2]=[s("构建信息")])),_:1,__:[2]}),e(_,{lines:"one"},{default:t(()=>[e(o,{title:"版本",subtitle:l.value.build.version},{prepend:t(()=>[e(a,{icon:"mdi-tag-outline"})]),_:1},8,["subtitle"]),e(o,{title:"Git Commit"},{prepend:t(()=>[e(a,{icon:"mdi-source-commit"})]),subtitle:t(()=>[l.value.build.gitCommit&&l.value.build.gitCommit!=="N/A"?(r(),b("a",{key:0,href:`https://github.com/SoraNetwork/EssayJudge.Backend/commit/${l.value.build.gitCommit}`,target:"_blank",rel:"noopener noreferrer",class:"text-decoration-none"},[s(n(l.value.build.gitCommit)+" ",1),e(a,{size:"x-small",class:"ml-1"},{default:t(()=>i[3]||(i[3]=[s("mdi-open-in-new")])),_:1,__:[3]})],8,z)):(r(),b("span",F,n(l.value.build.gitCommit),1))]),_:1})]),_:1})]),_:1})]),_:1}),e(m,{cols:"12",md:"6"},{default:t(()=>[e(v,null,{default:t(()=>[e(f,null,{default:t(()=>i[4]||(i[4]=[s("应用详情")])),_:1,__:[4]}),e(_,{lines:"one"},{default:t(()=>[e(o,{title:"环境",subtitle:l.value.application.environment},{prepend:t(()=>[e(a,{icon:"mdi-laptop"})]),_:1},8,["subtitle"]),e(o,{title:"框架",subtitle:l.value.application.framework},{prepend:t(()=>[e(a,{icon:"mdi-dot-net"})]),_:1},8,["subtitle"]),e(o,{title:"内存占用"},{prepend:t(()=>[e(a,{icon:"mdi-memory"})]),append:t(()=>[u("div",G,[u("span",null,n(l.value.application.memoryUsage),1),e(w,{"model-value":h(l.value.application.memoryUsage),color:"primary",height:"6",rounded:"",class:"mt-1"},null,8,["model-value"])])]),_:1}),e(o,{title:"已分配内存"},{prepend:t(()=>[e(a,{icon:"mdi-chip"})]),append:t(()=>[u("div",H,[u("span",null,n(l.value.application.totalAllocatedMemory),1),e(w,{"model-value":h(l.value.application.totalAllocatedMemory),color:"secondary",height:"6",rounded:"",class:"mt-1"},null,8,["model-value"])])]),_:1}),e(o,{title:"线程数",subtitle:l.value.application.threadCount},{prepend:t(()=>[e(a,{icon:"mdi-thread"})]),_:1},8,["subtitle"])]),_:1})]),_:1})]),_:1}),e(m,{cols:"12",md:"6"},{default:t(()=>[e(v,null,{default:t(()=>[e(f,null,{default:t(()=>i[5]||(i[5]=[s("系统信息")])),_:1,__:[5]}),e(_,{lines:"one"},{default:t(()=>[e(o,{title:"主机名",subtitle:l.value.system.hostName},{prepend:t(()=>[e(a,{icon:"mdi-desktop-classic"})]),_:1},8,["subtitle"]),e(o,{title:"服务器 IP",subtitle:l.value.system.serverIpAddresses},{prepend:t(()=>[e(a,{icon:"mdi-ip-network-outline"})]),_:1},8,["subtitle"]),e(o,{title:"操作系统",subtitle:l.value.system.os},{prepend:t(()=>[e(a,{icon:"mdi-microsoft-windows"})]),_:1},8,["subtitle"]),e(o,{title:"处理器核心数",subtitle:l.value.system.processorCount},{prepend:t(()=>[e(a,{icon:"mdi-cpu-64-bit"})]),_:1},8,["subtitle"]),e(o,{title:"你的 IP",subtitle:l.value.request.clientIp},{prepend:t(()=>[e(a,{icon:"mdi-account-box-outline"})]),_:1},8,["subtitle"])]),_:1})]),_:1})]),_:1})]),_:1})):x("",!0)]),_:1}))}}),oe=q(J,[["__scopeId","data-v-c96e5b29"]]);export{oe as default};
