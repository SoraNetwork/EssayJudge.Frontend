import{s as E,c as T,d as N,v as z}from"./VList-Bw5JRA7I.js";import{V as d,p as V}from"./VAvatar-Cjt3-t6c.js";import{b as y,V as _}from"./VCard-Baw6fKXM.js";import{a as A,V as c}from"./VRow-D5wFdFeI.js";import{a as b}from"./VSelect-C7-6oE3D.js";import{V as F}from"./VDataTable-Dprc95IX.js";import{V as U}from"./VTooltip-CGE0j1jY.js";import{V as $}from"./VChip-CTpQQSB7.js";import{Q as j,r as i,d as H,Y as S,W as f,H as x,x as o,X as a,_ as n,V as L,Z as w}from"./index--uryIc9t.js";/* empty css              */import"./VTextField-B7WNoRZT.js";import"./forwardRefs-TdIUcFqw.js";import"./VOverlay-CaEAIGL2.js";import"./dialog-transition-C45ZtiWV.js";const M={class:"d-flex justify-space-between align-center mb-4"},Q={key:1},ne=j({__name:"index",setup(R){function C(e){const t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString(void 0,t)}const k=[],p=i([]),v=i([]),g=i([]),u=i(!1),m=i(""),s=i({assignmentId:void 0,studentId:void 0});async function r(){u.value=!0;try{const e=await E(s.value);p.value=e||[]}catch(e){console.error("获取作文列表失败:",e)}finally{u.value=!1}}function D(e){if(e!=null)return e>=90?"green":e>=75?"light-green":e>=60?"orange":"red"}async function I(){try{const e=await T();v.value=e||[]}catch(e){console.error("获取测验列表失败:",e)}}async function h(){try{const e=await N({});g.value=e||[]}catch(e){console.error("获取学生列表失败:",e)}}async function B(e){m.value=e.id;try{await z(e.id),await r()}catch(t){console.error("提交评测失败:",t)}finally{m.value=""}}return H(()=>{r(),I(),h()}),(e,t)=>(f(),S("div",null,[x("div",M,[t[3]||(t[3]=x("h1",{class:"text-h4"},"作文管理",-1)),o(d,{color:"primary",to:"/essays/upload","prepend-icon":"mdi-upload"},{default:a(()=>t[2]||(t[2]=[n(" 上传批改 ")])),_:1,__:[2]})]),o(_,{class:"mb-4"},{default:a(()=>[o(y,null,{default:a(()=>[o(A,null,{default:a(()=>[o(c,{cols:"12",md:"4"},{default:a(()=>[o(b,{modelValue:s.value.assignmentId,"onUpdate:modelValue":[t[0]||(t[0]=l=>s.value.assignmentId=l),r],label:"测验题目",items:v.value,"item-title":"title","item-value":"id",clearable:""},null,8,["modelValue","items"])]),_:1}),o(c,{cols:"12",md:"4"},{default:a(()=>[o(b,{modelValue:s.value.studentId,"onUpdate:modelValue":[t[1]||(t[1]=l=>s.value.studentId=l),r],label:"学生",items:g.value,"item-title":"name","item-value":"id",clearable:""},null,8,["modelValue","items"])]),_:1}),o(c,{cols:"12",md:"4"},{default:a(()=>[o(d,{color:"primary",onClick:r,"prepend-icon":"mdi-refresh"},{default:a(()=>t[4]||(t[4]=[n(" 刷新 ")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1})]),_:1}),o(_,null,{default:a(()=>[o(y,null,{default:a(()=>[o(F,{headers:k,items:p.value,loading:u.value,"loading-text":"加载中...","no-data-text":"暂无数据"},{"item.submissionDate":a(({item:l})=>[n(w(C(l.submissionDate)),1)]),"item.finalScore":a(({item:l})=>[l.finalScore!==null&&l.finalScore!==void 0?(f(),L($,{key:0,color:D(l.finalScore),"text-color":"white"},{default:a(()=>[n(w(l.finalScore),1)]),_:2},1032,["color"])):(f(),S("span",Q,"未评分"))]),"item.actions":a(({item:l})=>[o(d,{icon:"",variant:"text",size:"small",to:`/essays/${l.id}`},{default:a(()=>[o(V,null,{default:a(()=>t[5]||(t[5]=[n("mdi-eye")])),_:1,__:[5]})]),_:2},1032,["to"]),o(d,{icon:"",variant:"text",size:"small",color:"primary",onClick:W=>B(l),disabled:l.finalScore!==null&&l.finalScore!==void 0,loading:m.value===l.id},{default:a(()=>[o(V,null,{default:a(()=>t[6]||(t[6]=[n("mdi-check-circle")])),_:1,__:[6]}),o(U,{activator:"parent",location:"top"},{default:a(()=>t[7]||(t[7]=[n("提交评测")])),_:1,__:[7]})]),_:2},1032,["onClick","disabled","loading"])]),_:1},8,["items","loading"])]),_:1})]),_:1})]))}});export{ne as default};
