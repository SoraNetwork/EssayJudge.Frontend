import{V as E,s as T,g as N,a as $,n as z}from"./VOverlay-D7KLqul2.js";import{V as d,o as V}from"./VAvatar-D6tovhXD.js";import{b as y,V as _}from"./VTextField-Cbwj9afB.js";import{a as A,V as c}from"./VRow-9Ta8N-Ip.js";import{a as b}from"./VSelect-DF8LjojY.js";import{V as F}from"./VDataTable-yaTI-PlP.js";import{V as U}from"./VTooltip-DO5NOGv_.js";import{Q as j,r as s,d as H,Y as S,W as f,H as x,x as l,X as a,_ as n,V as L,$ as w}from"./index-DrtXJ76k.js";import"./scopeId-C9l49y41.js";/* empty css              */const M={class:"d-flex justify-space-between align-center mb-4"},Q={key:1},te=j({__name:"index",setup(R){function C(e){const t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(e).toLocaleDateString(void 0,t)}const k=[],p=s([]),v=s([]),g=s([]),u=s(!1),m=s(""),i=s({assignmentId:void 0,studentId:void 0});async function r(){u.value=!0;try{const e=await T(i.value);p.value=e||[]}catch(e){console.error("获取作文列表失败:",e)}finally{u.value=!1}}function D(e){if(e!=null)return e>=90?"green":e>=75?"light-green":e>=60?"orange":"red"}async function I(){try{const e=await N();v.value=e||[]}catch(e){console.error("获取测验列表失败:",e)}}async function h(){try{const e=await $({});g.value=e||[]}catch(e){console.error("获取学生列表失败:",e)}}async function B(e){m.value=e.id;try{await z(e.id),await r()}catch(t){console.error("提交评测失败:",t)}finally{m.value=""}}return H(()=>{r(),I(),h()}),(e,t)=>(f(),S("div",null,[x("div",M,[t[3]||(t[3]=x("h1",{class:"text-h4"},"作文管理",-1)),l(d,{color:"primary",to:"/essays/upload","prepend-icon":"mdi-upload"},{default:a(()=>t[2]||(t[2]=[n(" 上传批改 ")])),_:1,__:[2]})]),l(_,{class:"mb-4"},{default:a(()=>[l(y,null,{default:a(()=>[l(A,null,{default:a(()=>[l(c,{cols:"12",md:"4"},{default:a(()=>[l(b,{modelValue:i.value.assignmentId,"onUpdate:modelValue":[t[0]||(t[0]=o=>i.value.assignmentId=o),r],label:"测验题目",items:v.value,"item-title":"title","item-value":"id",clearable:""},null,8,["modelValue","items"])]),_:1}),l(c,{cols:"12",md:"4"},{default:a(()=>[l(b,{modelValue:i.value.studentId,"onUpdate:modelValue":[t[1]||(t[1]=o=>i.value.studentId=o),r],label:"学生",items:g.value,"item-title":"name","item-value":"id",clearable:""},null,8,["modelValue","items"])]),_:1}),l(c,{cols:"12",md:"4"},{default:a(()=>[l(d,{color:"primary",onClick:r,"prepend-icon":"mdi-refresh"},{default:a(()=>t[4]||(t[4]=[n(" 刷新 ")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1})]),_:1}),l(_,null,{default:a(()=>[l(y,null,{default:a(()=>[l(F,{headers:k,items:p.value,loading:u.value,"loading-text":"加载中...","no-data-text":"暂无数据"},{"item.submissionDate":a(({item:o})=>[n(w(C(o.submissionDate)),1)]),"item.finalScore":a(({item:o})=>[o.finalScore!==null&&o.finalScore!==void 0?(f(),L(E,{key:0,color:D(o.finalScore),"text-color":"white"},{default:a(()=>[n(w(o.finalScore),1)]),_:2},1032,["color"])):(f(),S("span",Q,"未评分"))]),"item.actions":a(({item:o})=>[l(d,{icon:"",variant:"text",size:"small",to:`/essays/${o.id}`},{default:a(()=>[l(V,null,{default:a(()=>t[5]||(t[5]=[n("mdi-eye")])),_:1,__:[5]})]),_:2},1032,["to"]),l(d,{icon:"",variant:"text",size:"small",color:"primary",onClick:W=>B(o),disabled:o.finalScore!==null&&o.finalScore!==void 0,loading:m.value===o.id},{default:a(()=>[l(V,null,{default:a(()=>t[6]||(t[6]=[n("mdi-check-circle")])),_:1,__:[6]}),l(U,{activator:"parent",location:"top"},{default:a(()=>t[7]||(t[7]=[n("提交评测")])),_:1,__:[7]})]),_:2},1032,["onClick","disabled","loading"])]),_:1},8,["items","loading"])]),_:1})]),_:1})]))}});export{te as default};
